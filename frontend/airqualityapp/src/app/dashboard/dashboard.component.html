<div *ngIf="isLoading">
  <p>Učitavanje...</p>
</div>

<div *ngIf="!isLoading && !latestSensorReadings && errorMessage">
  <p>{{ errorMessage }}</p>
  <button (click)="loadLatestReadings()">Ponovni pokušaj</button>
</div>

<div class="dashboard-container" *ngIf="!isLoading && latestSensorReadings">
  <div class="reading-time">
    <p><strong>Vrijeme očitanja:</strong> {{ formatTimestamp() }}</p>
  </div>
  <h2>Kvaliteta zraka</h2>
  <div class="sensor-grid">
    <div class="sensor-card">
      <div class="sensor-header">
        <h3>PM1</h3>
        <span class="sensor-unit">μg/m³</span>
      </div>
      <div class="sensor-value">
        {{ latestSensorReadings.pms5003Dto.pm1 }}
      </div>
    </div>
    <div class="sensor-card">
      <div class="sensor-header">
        <h3>PM2.5</h3>
        <span class="sensor-unit">μg/m³</span>
      </div>
      <div class="sensor-value" [class]="getPM25Status().cssClass">
        {{ latestSensorReadings.pms5003Dto.pm2_5 }}
      </div>
      <div class="sensor-status">
        {{ getPM25Status().level }}
      </div>
    </div>
    <div class="sensor-card">
      <div class="sensor-header">
        <h3>PM10</h3>
        <span class="sensor-unit">μg/m³</span>
      </div>
      <div class="sensor-value" [class]="getPM10Status().cssClass">
        {{ latestSensorReadings.pms5003Dto.pm10 }}
      </div>
      <div class="sensor-status">
        {{ getPM10Status().level }}
      </div>
    </div>
    <div class="sensor-card">
      <div class="sensor-header">
        <h3>CO2</h3>
        <span class="sensor-unit">ppm</span>
      </div>
      <div class="sensor-value" [class]="getCO2Status().cssClass">
        {{ latestSensorReadings.scd40Dto.co2 }}
      </div>
      <div class="sensor-status">
        {{ getCO2Status().level }}
      </div>
    </div>
    <div class="sensor-card">
      <div class="sensor-header">
        <h3>VOC</h3>
        <span class="sensor-unit"></span>
      </div>
      <div class="sensor-value" [class]="getVOCStatus().cssClass">
        {{ latestSensorReadings.sgp40Dto.vocIndex }}
      </div>
      <div class="sensor-status">
        {{ getVOCStatus().level }}
      </div>
    </div>
  </div>
  <h2>Klimatski uvjeti</h2>
  <div class="atmospheric-conditions">
    <div class="condition-card">
      <div class="condition-header">
        <h3>Temperatura zraka</h3>
        <span class="condition-unit">°C</span>
      </div>
      <div class="condition-value">{{ latestSensorReadings.bme280Dto.temperature | number:'1.1-1' }}</div>
    </div>
    <div class="condition-card">
      <div class="condition-header">
        <h3>Relativna vlažnost</h3>
        <span class="condition-unit">%</span>
      </div>
      <div class="condition-value">{{ latestSensorReadings.bme280Dto.humidity | number:'1.1-1' }}</div>
    </div>
    <div class="condition-card">
      <div class="condition-header">
        <h3>Tlak zraka</h3>
        <span class="condition-unit">hPa</span>
      </div>
      <div class="condition-value">{{ latestSensorReadings.bme280Dto.pressure | number:'1.1-1' }}</div>
    </div>
  </div>
</div>
